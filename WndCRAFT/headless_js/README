This is the headless version of the Monte Carlo sampling algorithm for the ODU/VMASC Attack Ladder Tool. 

It is written in nodejs.

It requires 6 inputs:
1) The filepath of the JSON file describing the Attack Ladder to be sampled.

2) The number of Monte Carlo samples to generate.

3) The filepath of the JSON file specifying which rungs you would like to fix a value for and what value (yes/no) you would like to fix that value to.
   If no such file exists simply use "NA" or "NONE" in place of this input.
   
   Example of fixed value JSON file:
   {
     "yes":["1", "4"],
     "no": ["2", "6"]
   }
   Here the numbers reflect the rung ids (from the attack ladder file) for the respective value the user would like to fix the rung value to.
   
4) The filepath of the JSON file specifying MITRE ATT&CK Group you would like to do the Monte Carlo Sampling against.
   MITRE ATT&CK Groups can be explored and the JSON files can be downloaded here: https://attack.mitre.org/groups/
   If no such file exists simply use "NA" or "NONE" in place of this input.  

5) The filepath of the JSON file output for the generated Monte Carlo samples.

6) The file path of the JSON file output for the summary results of the generated Monte Carlo samples.


Application example usage:

[NO FIXED RUNGS, NO MITRE ATT&CK GROUP]
node headless_sampler.js "../files/nets/FullAttackLadderWithVulsAndFuncs.json" 10000 "NA" "NA" "samples.json" "summary.json"

[ONLY MITRE ATT&CK GROUP, NO FIXED RUNGS]
node headless_sampler.js "../files/nets/FullAttackLadderWithVulsAndFuncs.json" 10000 "NA" "../files/attack_groups/G0034-enterprise-layer.json" "samples.json" "summary.json"

[NO MITRE ATT&CK GROUP, ONLY FIXED RUNGS]
node headless_sampler.js "../files/nets/FullAttackLadderWithVulsAndFuncs.json" 10000 "fixed.json" "NA" "samples.json" "summary.json"

[ALL INPUTS: FIXED RUNGS AND MITRE ATT&CK GROUP]
PLEASE NOTE: Under this scenario fixed rungs and attack group techniques can compete with one another.
             The order of operations is we apply the attack group techniques first and then the fixed rung values. 
			 As a result fixed rung values will override any conflicts with the attack group techniques.
node headless_sampler.js "../files/nets/FullAttackLadderWithVulsAndFuncs.json" 10000 "fixed.json" "../files/attack_groups/G0034-enterprise-layer.json" "samples.json" "summary.json"

[BATCH MITRE ATT&CK GROUP MODE]
PLEASE NOTE: In this mode the MITRE ATT&CK GROUP input needs to be a directory containing only MITRE ATT&CK GROUP input files. Also the samples (input #5) and summary (input #6) inputs also need to be directories. In BATCH MITRE ATT&CK GROUP MODE the headless version of the tool will fill the samples and summary directory with the resulting json files from applying each MITRE ATT&CK GROUP in the specified directory to the attack ladder.
node headless_sampler.js "../files/nets/FullAttackLadderWithVulsAndFuncs.json" 100 "NA" "../files/attack_groups/" "samples/" "summary/"



Version information:
node: v21.6.0

Interpreting Output:
In both the summary and the sample files each entry has the numeric rung id and the value for the rung generated by the sampling. 
